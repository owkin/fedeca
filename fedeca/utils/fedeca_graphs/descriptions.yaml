moment1: "Uncentered (scalar) moments of order 1 for each covariate used by the Cox model. Therefore it is a list of scalars of size the number of covariates. In the case of IPTW the only covariate is the treatment."
moment2: "Uncentered (scalar) moments of order 2 for each covariate used by the Cox model. Therefore it is a list of scalars of size the number of covariates. In the case of IPTW the only covariate is the treatment."
n_samples: "The number of samples (scalar) of each center"
global_centered_moment_1: "Global centered moment of order 1 for each covariate used by the Cox model. Therefore it is a list of scalars of size the number of covariates. In the case of IPTW the only covariate is the treatment."
global_centered_moment_2: "Global centered moment of order 2 for each covariate used by the Cox model. Therefore it is a list of scalars of size the number of covariates. In the case of IPTW the only covariate is the treatment."
global_uncentered_moment_1: "Global uncentered moment of order 1 for each covariate used by the Cox model. Therefore it is a list of scalars of size the number of covariates. In the case of IPTW the only covariate is the treatment. Those values are not used in fact and are computed for testing purposes."
global_uncentered_moment_2: "Global uncentered moment of order 2 for each covariate used by the Cox model. Therefore it is a list of scalars of size the number of covariates. In the case of IPTW the only covariate is the treatment. Those values are not used in fact and are computed for testing purposes."
total_n_samples: "The total number of samples (scalar) across centers."
global_survival_statistics: "A dict whose values are the ones that will not change throughout trainings and that are used in the computation of gradients and hessian for the Cox model, contains all distinct event times (list of scalars), the global sum of features of all samples on each distinct event times (list of vectors of dimension the number of covariates), the number of events per distinct times (list of scalars) and the weighted sum of samples on each distinct event times (list of scalars)."
sum_features_on_events: "the global sum of features of all samples on each distinct event times"
distinct_events_times: "All distinct event times which is list of scalars."
number_events_by_time: "The number of events per distinct times (scalar)."
total_number_samples: "The total number of samples (scalar)."
weights_counts_on_events: "The weighted sum of samples on each distinct event times (list of scalars)."
moments: "The global centered moments of order 1 and 2 of each covariate of the Cox model (moment1, moment2 which are forwarded)"
local_phi_stats: "A dict whose values are the sums on risk sets of different quantities used to compute gradient and or hessians. Its values are: 1. the local sum on each risk set of risk_phi which is a scalar (thus a list of scalars). 2. the local sum on each risk set of risk_phi_x which is of dimension the number of features (a list of vectors). and 3. the local sum on each risk set of risk_phi_x_x which is of the dimension of the number of features squared (a list of matrices)."
hessian: "The hessian of the model of dimension the number of covariates squared."
gradient: "The global gradient of the Cox model of dimension the number of covariates."
gradients: "The local gradient of the propensity model of dimension the number of covariates."
second_part_ll: "Quantity necessary to compute the log-likelihood."
gradient_shape: "The shape of the gradient (scalar)."
global_risk_phi_list: "Sums on each risk sets of risk_phi globally that is a list of scalars."
global_risk_phi_x_list: "Sums on each risk sets of risk_phi_x globally that is a list of vector of dimensions number of features."
parameters_update: "The Newton-Raphson step computed with the global hessian."


# Examples on how to differentiate quantities with the same name
# patterns XX_YY_ZZ
# local_features:
#   "7": $\xz_{k}  := \design_k^{\top} \ncounts_{k}$.
#   "16_42" : For each active gene $g$, the projected features $\design_k^{\top} \wmat_{k,g} \phi_{k,g}$, where $\phi_{k,i,g} = \log\left(\frac{\mean_{k,i,g}}{\sfactor_{i}}\right) + \frac{\counts_{k,i,g} - \mean_{k,i,g}}{\mean_{k,i,g}}$ and $\phi_{k,g}$ is the vector of $(\phi_{k,i,g})_{1 \leq i \leq \nsamples_k}$.
#   "77_111": $\xz_{k}  := \design_k^{\top} \ncounts_{k}$, where $\ncounts_{k}$ is the normalized counts in the center $k$ on the set of genes to replace, where the value of Cook's outliers have been replaced using a trimmed mean.
